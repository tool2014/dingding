webpackJsonp([1],{39:function(t,e){},40:function(t,e,a){function i(t){a(81)}var s=a(82)(a(42),a(83),i,null,null);t.exports=s.exports},41:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a(39),s=(a.n(i),a(29)),r=a(40),n=a.n(r);s.a.config.productionTip=!1,new s.a({el:"#app",template:"<App/>",components:{App:n.a}})},42:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a(43),s=a.n(i),r=a(47),n=a.n(r),o=a(44),l=a.n(o),c=a(29);e.default={name:"app",data:function(){return{date:"",year:"",mouth:"",days:"",weeks:[],workbook:"",rABS:!1,excelData:"",SheetNames:1,data:[],headers:{},headers_row:3,table_thead:[],name_list:[],table_row:[],name_value:"",first:!0,table_tbody:[],tmpDown:"",href:"",tmpWB:"",tableDataObject:[],tableDataArray:[]}},created:function(){this.getDays()},methods:{getWeeks:function(){for(var t=new Date,e=1;e<=this.days;e++)t.setFullYear(this.year,this.mouth-1,e),0===t.getDay()?this.weeks.push("日"):6===t.getDay()?this.weeks.push("六"):5===t.getDay()?this.weeks.push("五"):4===t.getDay()?this.weeks.push("四"):3===t.getDay()?this.weeks.push("三"):2===t.getDay()?this.weeks.push("二"):1===t.getDay()&&this.weeks.push("一")},getDays:function(){this.date=new Date,this.year=this.date.getFullYear(),this.mouth=this.date.getMonth(),2===this.mouth?this.days=this.year%4==0?29:28:1===this.mouth||3===this.mouth||5===this.mouth||7===this.mouth||8===this.mouth||10===this.mouth||12===this.mouth?this.days=31:this.days=30,this.getWeeks()},importfile:function(){var t=this,e=document.getElementById("file");if(e.files){var a=e.files[0],i=new FileReader;i.onload=function(e){var a=e.target.result;t.workbook=window.XLSX.read(a,{type:"binary"});var i=t.workbook.SheetNames[3],s=t.workbook.Sheets[i];t.add(s)},i.readAsBinaryString(a)}},add:function(t){var e=this,a=l()(t),i=new RegExp(/^([a-zA-Z]+)(\d+)$/g);console.log(this.tableDataArray),a.filter(function(t){return"!"!==t[0]}).filter(function(a){var s=i.exec(a);i.lastIndex=0;var r=t[a].v;if(e.colToIndex(s[1])>4){r=r.split("\n")[r.split("\n").length-1];var n=r.split(":");if(n[0]&&"string"==typeof n[0]){var o=Number(n[0]);o===o&&o>7&&o<13&&(r=void 0)}}e.tableDataObject[s[2]]||(e.tableDataObject[s[2]]={}),e.tableDataObject[s[2]][s[1]]=r,e.tableDataArray[s[2]]||(e.tableDataArray[s[2]]=[],c.a.set(e.tableDataArray,""+s[2],[])),e.$set(e.tableDataArray[s[2]],e.colToIndex(s[1]),r)}),this.filter()},colToIndex:function(t){function e(t){return t.charCodeAt(0)-96}t=t.toLocaleLowerCase();var a=0;return t.split("").reverse().forEach(function(t,i){a+=e(t)*Math.pow(26,i)}),a-1},filter:function(){var t=this;window.a=this,this.data=this.copyData(this.tableDataArray),this.data.forEach(function(e){for(var a=0;a<t.days+5;a++)e[a]||(e[a]=void 0);console.log(e)}),this.data=this.data.filter(function(t,e){return e>3}).map(function(t){return t.filter(function(t,e){return 0===e||e>4})})},copyData:function(t){var e=this,a=void 0;if(t instanceof Array)a=t.slice(),a=a.map(function(t){return e.copyData(t)});else if((void 0===t?"undefined":n()(t))!==Object||null===t)return t;return a},downloadExl:function(){var t=this,e=this.data,a=[];a.push("姓名-星期");for(var i=0;i<this.weeks.length;i++)a.push(this.weeks[i]),i===this.weeks.length-1&&(console.log(i),e.unshift(a));for(var r=["日期"],n=1;n<=this.days;n++)r.push(this.mouth+"/"+n),n===this.days&&e.unshift(r);var o=[];e.map(function(e,a){return r.map(function(i,r){return s()({},{v:e[r],position:(r>25?t.getCharCol(r):String.fromCharCode(65+r))+(a+1)})})}).reduce(function(t,e){return t.concat(e)}).forEach(function(t,e){o[t.position]={v:t.v}});var c=l()(o);this.tmpWB={SheetNames:["打卡时间"],Sheets:{"打卡时间":s()({},o,{"!ref":c[0]+":"+c[c.length-1]})}},this.tmpDown=new Blob([this.s2ab(window.XLSX.write(this.tmpWB,{bookType:"xlsx",bookSST:!1,type:"binary"}))],{type:""}),console.log(this.tmpWB),console.log(this.tmpDown),window.saveAs(this.tmpDown,"考勤表.xlsx")},s2ab:function(t){for(var e=new ArrayBuffer(t.length),a=new Uint8Array(e),i=0;i!==t.length;++i)a[i]=255&t.charCodeAt(i);return e},getCharCol:function(t){for(var e="",a=0;t>0;)a=t%26+1,e=String.fromCharCode(a+64)+e,t=(t-a)/26;return e}}}},81:function(t,e){},83:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"app"}},[a("div",{staticClass:"index container-fluid"},[a("div",{staticClass:"row",staticStyle:{height:"50px"}},[a("form",{staticClass:"form",staticStyle:{position:"fixed","background-color":"white"},attrs:{role:"form"}},[a("div",{staticClass:"form-group col-md-3 input"},[a("div",{staticClass:"input-group",staticStyle:{cursor:"pointer"}},[t._m(0),t._v(" "),a("input",{staticClass:"form-control",staticStyle:{cursor:"pointer"},attrs:{type:"file",id:"file"},on:{change:function(e){t.importfile()}}})])]),t._v(" "),a("div",{staticClass:"form-group col-md-3"},[a("a",{staticClass:"btn btn-primary",staticStyle:{"font-weight":"bold"},attrs:{href:"javascript:void(0)"},on:{click:function(e){t.downloadExl()}}},[t._v("导出")])])])]),t._v(" "),t.data.length?a("div",{staticClass:"row"},[a("table",{staticClass:"table table-bordered table-hover text-center"},[a("thead",[a("tr",[a("td",{staticClass:"text-center",staticStyle:{"min-width":"120px"}},[t._v("日期")]),t._v(" "),t._l(t.days,function(e){return a("td",{staticClass:"text-center",staticStyle:{"min-width":"120px"}},[t._v(t._s(t.mouth)+"/"+t._s(e))])})],2),t._v(" "),a("tr",[a("td",{staticClass:"text-center",staticStyle:{"min-width":"120px"}},[t._v("姓名\\星期")]),t._v(" "),t._l(t.weeks,function(e){return a("td",{staticClass:"text-center",staticStyle:{"min-width":"120px"}},[t._v(t._s(e))])})],2)]),t._v(" "),a("tbody",t._l(t.data,function(e,i){return a("tr",{key:"i"},t._l(e,function(e,i){return a("td",[t._v(t._s("18:00:00"==e?e+"(缺卡)":e))])}))}))])]):t._e()])])},staticRenderFns:[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"input-group-addon",staticStyle:{"background-color":"#428BCA",color:"#fff"}},[a("label",{staticStyle:{"margin-bottom":"0",cursor:"pointer"},attrs:{for:"file"}},[t._v("导入")])])}]}}},[41]);
//# sourceMappingURL=app.b1f4e239a1c74ad6a1f3.js.map